<div class="container-fluid">

    <div class="card">
        
        <div class="card-header">
            <h2>Schedules</h2>
        </div>
        
        <div class="card-body">
            <table class="table table-striped table-hover" >
                <thead>
                    <tr>
                        <th scope="col">No</th>
                        <th scope="col">Test Name</th>
                        <th scope="col">Start Time</th>
                        <th scope="col">End Time</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let header of scheduleHeaders; index as i" (click)="selectScheduleHeader(header)">
                        <th scope="row">{{ i + 1 }}</th>
                        <td>{{header.testName}}</td>
                        <td>{{header.startTime}}</td>
                        <td>{{header.endTime}}</td>
                    </tr>
                </tbody>
            </table>
        
            <div *ngIf="selectedHeader==undefined">
                <p class="alert alert-warning">Please select a schedule!</p>
            </div>
        </div>
    </div>

    <div class="card" *ngIf="selectedHeader!=undefined">
        <div class="card-header">
            <h4>
                {{selectedHeader.testName}}
            </h4>
        </div>

        <div class="card-body">

            <p>
                Start : {{selectedHeader.startTime}} <br>
                End : {{selectedHeader.endTime}}
            </p>

            <div class="card">
                <div class="card-header">
                    <h6>
                        Create Question
                    </h6>
                </div>

                <div class="card-body container">
                    <div class="form-group">
                        <label for="">
                            Question:
                        </label>
                        <input 
                        #question
                        (input) = "newQuestion.name = $event.target.value" 
                        type="text" 
                        class="form-control" 
                        placeholder="question" 
                        required>
                    </div>
                    
                    <label for="">
                        Question type:
                    </label>

                    <div class="form-group" (click)="setQuestionType(multiple,trueFalse,choose,essay,file)">
                        <div class="form-check">
                            <input #multiple type="radio" name="questionType" class="form-check-input">
                            <label for="" class="form-check-label">
                                Multiple choice
                            </label>
                        </div>

                        <div class="form-check">
                            <input #trueFalse type="radio" name="questionType" class="form-check-input">
                            <label for="" class="form-check-label">
                                True False
                            </label>
                        </div>

                        <div class="form-check">
                            <input #choose type="radio" name="questionType" class="form-check-input">
                            <label for="" class="form-check-label">
                                Choose from list
                            </label>
                        </div>

                        <div class="form-check">
                            <input #essay type="radio" name="questionType" class="form-check-input">
                            <label for="" class="form-check-label">
                                Essay
                            </label>
                        </div>

                        <div class="form-check">
                            <input #file type="radio" name="questionType" class="form-check-input">
                            <label for="" class="form-check-label">
                                Submit file
                            </label>
                        </div>
                    </div>

                    <div class="form-group" *ngIf="multiple.checked">
                        <div class="alert alert-info">
                            Question type: multiple choice
                        </div>
                        <div class="form-group">
                            <label for="">
                                Options :
                            </label>
    
                            <div class="form-group">
                                <input 
                                       type="text" class="form-control row" 
                                       placeholder="Option A" 
                                       required
                                       (input) ="multipleOptions[0] = $event.target.value;">
                            </div>

                            <div class="form-group">
                                <input 
                                      type="text" class="form-control row" 
                                      placeholder="Option B" 
                                      required
                                      (input) ="multipleOptions[1] = $event.target.value;">
                            </div>

                            <div class="form-group">
                                <input 
                                        type="text" class="form-control row" 
                                        placeholder="Option C" 
                                        required
                                        (input) ="multipleOptions[2] = $event.target.value;">
                            </div>

                            <div class="form-group">
                                <input 
                                        type="text" class="form-control row" 
                                        placeholder="Option D" 
                                        required
                                        (input) ="multipleOptions[3] = $event.target.value;">
                            </div>

                        </div>
                        
                        <div class="form-group">
                            <label for="">
                                Right Answer :
                            </label>
                            <select class="custom-select" (input)="multipleRightAnswer = $event.target.value">
                                <option 
                                    *ngFor="let opt of multipleOptions" 
                                    [value]="opt">
                                    {{opt}}
                                </option>
                            </select>
                        </div>

                    </div>

                    <div class="form-group" *ngIf="trueFalse.checked" (click)="setTrueFalseRightAnswer(trueAnswer.checked, falseAnswer.checked)" >
                        <div class="alert alert-info">
                            Question type: true false
                        </div>
                        <label for="">Right Answer :</label>

                        <div class="form-check">
                            <input
                            #trueAnswer 
                            checked
                            type="radio"
                            name="trueFalse" 
                            class="form-check-input">
                            <label for="" class="form-check-label">
                                True
                            </label>
                        </div>
                        <div class="form-check">
                            <input
                            #falseAnswer 
                            type="radio"
                            name="trueFalse" 
                            class="form-check-input">
                            <label for="" class="form-check-label">
                                False
                            </label>
                        </div>
                            
                    </div>

                    <div class="form-group" *ngIf="choose.checked">
                        <div class="alert alert-info">
                            Question type: Choose from list
                        </div>
                        <label for="">
                            new option:
                        </label>
                        <div class="input-group mb-3">
                            <input 
                                #chooseOption
                                (input) = "chooseOption.value = $event.target.value"
                                type="text" 
                                class="form-control" 
                                placeholder="new option" 
                                aria-label="new option" 
                                required
                                aria-describedby="button-addon">
                            <div class="input-group-append">
                                <button 
                                    class="btn btn-outline-secondary" 
                                    type="button" 
                                    id="button-addon"
                                    (click)="chooseOptions.push(chooseOption.value);">
                                    add
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="">
                                Right Answer :
                            </label>
                            <select class="custom-select" (input)="chooseRightAnswer = $event.target.value">
                                <option 
                                    *ngFor="let opt of chooseOptions" 
                                    [value]="opt">
                                    {{opt}}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group " *ngIf="essay.checked">
                        <div class="alert alert-info">
                            Question type: Essay
                        </div>
                    </div>
                    <div class="form-group " *ngIf="file.checked">
                        <div class="alert alert-info">
                            Question type: Submit file
                        </div>
                    </div>

                    <div class="form-group row" 
                        *ngIf="multiple.checked||
                            trueFalse.checked||
                            choose.checked||
                            essay.checked||
                            file.checked">
                        <button class="btn btn-primary" 
                        (click)="
                                addQuestion();
                                multiple.checked =
                                trueFalse.checked =
                                choose.checked =
                                essay.checked =
                                file.checked = false;
                                question.value = '';
                                ">
                            Submit
                        </button>
                    </div>

                </div>

            </div>

            <div class="card">
                <div class="card-header">
                    <h6>
                        Questions
                    </h6>
                </div>
                <div class="card-body">
                    <table class="table table-striped table-hover" *ngIf="selectedQuestions.length != 0">
                        <thead>
                            <tr>
                                <th scope="col">No</th>
                                <th scope="col">Question</th>
                                <th scope="col">Type</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let q of selectedQuestions; index as i">
                                <th scope="row">{{ i + 1 }}</th>
                                <td *ngIf="!q.isEdit">
                                    {{q.questionName}}
                                </td>
                                <td *ngIf="q.isEdit">
                                    <input 
                                    class="form-control"
                                    type="text" 
                                    [value]="q.questionName"
                                    (input)="editQuestion.name = $event.target.value;" 
                                    />
                                </td>
                                <td>{{q.questionTypeName}}</td>
                                <td *ngIf="q.isEdit">
                                    <button class="btn btn-primary ml-1" (click)="
                                    q.isEdit = !q.isEdit; saveQuestion(q.id)">
                                        Save
                                    </button>
                                    <button class="btn btn-danger ml-1" (click)="q.isEdit = !q.isEdit">
                                        Cancel
                                    </button>
                                </td>
                                <td *ngIf="!q.isEdit && !q.isDelete">
                                    <button class="btn btn-warning ml-1" (click)="q.isEdit=!q.isEdit;" >
                                        Edit
                                    </button>
                                    <button class="btn btn-danger ml-1" (click)="q.isDelete=!q.isDelete;" >
                                        Delete
                                    </button>
                                </td>
                                <td *ngIf="q.isDelete">
                                    <p>Are you sure ?</p>
                                    <button class="btn btn-primary ml-1"  (click)="deleteQuestion(q.id)">
                                        Yes
                                    </button>
                                    <button class="btn btn-danger ml-1" (click)="q.isDelete = !q.isDelete">
                                        No
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

    </div>
</div>